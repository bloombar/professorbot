/**
 * Run this script in order to generate a token.
 * The `code` variable must be set to the auth code generated by the google-oauth-generate-url.js script
 * 
 * Attribution: code from https://www.woolha.com/tutorials/node-js-using-google-sheets-api-with-oauth-2
 */

const fs = require('fs');
const { google } = require('googleapis');
  
// Replace with the code you've got from the previous script
const code = '4/AABBCC-abcdEFGH1-aBcDeaBcDeaBcDeaBcDeaBcDeaBcDeaBcDeaBcDeaBcDeaBcDeaBcDeaBcDeaBcDeaBcDe';

const credentials = JSON.parse(fs.readFileSync('google-client-secret.json', 'utf-8'));

const {
  client_secret: clientSecret,
  client_id: clientId,
  redirect_uris: redirectUris,
} = credentials.installed;

const oAuth2Client = new google.auth.OAuth2(
    clientId, clientSecret, redirectUris[0],
);

const getToken = async () => {
    const { tokens } = await oAuth2Client.getToken(code);
    console.info(tokens);
    fs.writeFileSync('google-oauth-token.json', JSON.stringify(tokens));
};

getToken();